webpackJsonp([6],{Ard5:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("oAV5"),i={data:function(){return{selectedDate:"",cols:[],tableData:[],tableLoading:!1,treeData:{children:"children",label:"label",id:"id",isLeaf:"isLeaf",disabled:"disabled"},curOrgName:"",searchCondition:{careworkerName:null,startDate:null,endDate:null,orgId:null,curPage:1,pageSize:100,totalSize:10},showOrgSearchDialog:!1}},mounted:function(){},methods:{signIn:function(e,t){var a=this,r=e;this.putRequest("/busi/routine",{careworkerId:e.row.careworkerId,date:e.column.property,isWorked:t}).then(function(e){console.log(e),e&&"200"===e.data.code?(r.row[r.column.property].signIn=t,a.$message({type:"success",message:e.data.msg})):a.$message.error({type:"fail",message:e.data.msg})})},orgSearchDialog:function(){this.showOrgSearchDialog=!0},loadChild:function(e,t){var a=this,r=null==e.parent?null:e.data.id,i=t;this.tableLoading=!0,this.postRequestJson("/busi/baseinfo/organization/list",{orgId:r,projectId:2}).then(function(e){if(a.tableLoading=!1,e&&200===e.status){for(var t=[],r=e.data.msg.result,l=0;l<r.length;l++)t.push({id:e.data.msg.result[l].id,label:e.data.msg.result[l].name,children:[],isLeaf:e.data.msg.result[l].isLeaf,disabled:!e.data.msg.result[l].isLeaf});i(t)}})},orgNodeClick:function(e,t){var a=[];a.push(e),this.$refs.tree.setCheckedNodes(a,!0)},orgClick:function(){var e=this.$refs.tree.getCheckedNodes();e.length>0&&(this.curOrgName=e[0].label,this.searchCondition.orgId=e[0].id),this.showOrgSearchDialog=!1},clearOrgInput:function(){this.curOrgName="",this.searchCondition.orgId=null},searchDutyInfoList:function(){var e=this;this.tableLoading=!0,this.searchCondition.startDate=this.searchCondition.endDate=null,this.cols=[],this.tableData=[];var t=function(e,t){var a=0,r="",i="";if(null!=e&&""!=e&&e.length>0){r=e[0],i=e[1];var n=new Date(r),o=new Date(i);a=Math.floor((o.getTime()-n.getTime())/864e5)+1}else{var s=new Date,c=s.getFullYear(),d=s.getMonth()+1;a=new Date(c,d,0).getDate(),s.setDate(1),r=s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate(),s.setDate(a),i=s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate()}if(a>31)return null;for(var u=new Date(r),g=0;g<a;g++){var p=l(u);t.cols.push({label:p,prop:p,type:"normal"}),u.setDate(u.getDate()+1)}return{start:r,end:i}}(this.selectedDate,this);null!=t?(this.searchCondition.startDate=t.start,this.searchCondition.endDate=t.end,this.postRequestJson("/busi/routine/list",this.searchCondition).then(function(t){if(e.tableLoading=!1,t&&"200"===t.data.code){console.log(t.data.msg.result);for(var a=t.data.msg.result,r=0;r<a.length;r++){for(var i=a[r].routineInfoDTO,l={careworkerId:a[r].careworkerId,careworkerName:a[r].careworkerName},o=0;o<i.length;o++)null==l[i[o].date]&&(l[i[o].date]={info:[],signIn:!0}),l[i[o].date].info.push(n(i[o])),l[i[o].date].signIn=l[i[o].date].signIn&&i[o].isWorked;console.log(l),e.tableData.push(l)}}else e.$message.error({type:"fail",message:t.data.msg})})):this.$message.error({type:"fail",message:"时间间隔不得超过一个月"})}}};function l(e){return e.getFullYear()+"-"+Object(r.b)(e.getMonth()+1+"")+"-"+Object(r.b)(e.getDate()+"")}function n(e){if(null!=e&&""!=e)return e.schedule+"-"+e.property+"-"+e.dayIndex+"天"}var o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{staticClass:"demo-form-inline",staticStyle:{"margin-top":"20px"},attrs:{inline:!0}},[a("el-row",{staticStyle:{"margin-left":"-200px"}},[a("el-form-item",{attrs:{label:"员工姓名"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini"},model:{value:e.searchCondition.careworkerName,callback:function(t){e.$set(e.searchCondition,"careworkerName",t)},expression:"searchCondition.careworkerName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"科室"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini"},on:{focus:e.orgSearchDialog},model:{value:e.curOrgName,callback:function(t){e.curOrgName=t},expression:"curOrgName"}},[a("i",{staticClass:"el-input__icon el-icon-circle-close",attrs:{slot:"suffix"},on:{click:e.clearOrgInput},slot:"suffix"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"时间间隔"}},[a("div",{staticClass:"block"},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd",size:"mini"},model:{value:e.selectedDate,callback:function(t){e.selectedDate=t},expression:"selectedDate"}})],1)]),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"mini",icon:"el-icon-search",type:"primary"},on:{click:e.searchDutyInfoList}},[e._v("查 询")])],1)],1),e._v(" "),a("el-row",[a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":"",data:e.tableData,border:"","v-loading":e.tableLoading,stripe:""}},[e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"careworkerName",fixed:"",align:"center",label:"员工姓名",width:"150"}}),e._v(" "),e._l(e.cols,function(t,r){return["normal"===t.type?a("el-table-column",{attrs:{prop:t.prop,label:t.label,width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[null!=t.row[t.column.property]?a("el-col",[e._l(t.row[t.column.property].info,function(t){return a("el-row",{key:t},[e._v("\n                    "+e._s(t)+"\n                  ")])}),e._v(" "),t.row[t.column.property].signIn?a("el-row",[a("el-row",{staticStyle:{color:"green"}},[e._v("\n                      已签到\n                    ")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.signIn(t,!1)}}},[e._v("\n                      取消签到\n                    ")])],1):a("el-row",[a("el-row",{staticStyle:{color:"red"}},[e._v("\n                      未签到\n                    ")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.signIn(t,!0)}}},[e._v("\n                      签到\n                    ")])],1)],2):a("el-col",[a("el-row",[e._v("\n                    没有排班\n                  ")])],1)]}}])}):e._e()]})],2),e._v(" "),a("el-pagination",{attrs:{"current-page":e.searchCondition.curPage,"page-size":e.searchCondition.pageSize,layout:"prev, pager, next, jumper",total:e.searchCondition.totalSize},on:{"current-change":e.searchDutyInfoList,"update:currentPage":function(t){e.$set(e.searchCondition,"curPage",t)}}})],1)])],1),e._v(" "),a("el-form",{ref:"OrgForm",staticStyle:{margin:"0px",padding:"0px"}},[a("div",{staticStyle:{"text-align":"left"}},[a("el-dialog",{staticStyle:{padding:"0px"},attrs:{title:"科室参照","close-on-click-modal":!1,visible:e.showOrgSearchDialog,width:"30%"},on:{"update:visible":function(t){e.showOrgSearchDialog=t}}},[a("el-row",[a("el-tree",{ref:"tree",attrs:{props:e.treeData,load:e.loadChild,"node-key":"id",lazy:"","show-checkbox":""},on:{check:e.orgNodeClick}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.showOrgSearchDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.orgClick}},[e._v("确 定")])],1)],1)],1)])],1)},staticRenderFns:[]};var s=a("VU/8")(i,o,!1,function(e){a("NlQ/")},"data-v-f322238c",null);t.default=s.exports},"NlQ/":function(e,t){},Wwo0:function(e,t){},ZPWa:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={data:function(){return{dialogVisible:!1,temptit:["待排班","已选中"],dateWork:"",dialogTitle:"",schedule:"1",careData:[],dataList:[],gradeData:[{grade:"1",mame:"白班"},{grade:"2",mame:"夜班"}]}},mounted:function(){this.getDataList()},methods:{getDataList:function(){var e=this;this.postRequestJson("/busi/careworker/list",{name:"",curPage:1,pageSize:1e3,isOnWork:!0,projectId:this.$store.state.user.projectId}).then(function(t){if(e.tableLoading=!1,t&&200===t.status){console.log(t.data.msg.result);for(var a=[],r=0;r<t.data.msg.result.length;r++)a.push({key:t.data.msg.result[r].careworkerId,label:t.data.msg.result[r].name});e.dataList=a}})},submitOnclik:function(){var e=this;this.postRequestJson("/busi/routine",{date:this.dateWork,dayIndex:1,schedule:this.schedule,property:1,careworkerIds:this.careData}).then(function(t){e.tableLoading=!1,t&&200===t.status&&e.getMasgg(t.data.msg)})},getMasgg:function(e){var t=this;this.$confirm(e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.dialogVisible=!1}).catch(function(){})}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"margin-top":"20px"}},[a("el-form",[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"日期:"}},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",size:"mini",placeholder:"选择日期"},model:{value:e.dateWork,callback:function(t){e.dateWork=t},expression:"dateWork"}})],1)])],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"制定的班次:"}},[a("el-select",{attrs:{size:"mini",placeholder:"制定的班次"},model:{value:e.schedule,callback:function(t){e.schedule=t},expression:"schedule"}},e._l(e.gradeData,function(e){return a("el-option",{key:e.grade,attrs:{label:e.mame,value:e.grade}})}))],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:14}},[[a("el-transfer",{attrs:{data:e.dataList,titles:e.temptit},model:{value:e.careData,callback:function(t){e.careData=t},expression:"careData"}})]],2)],1),e._v(" "),a("el-row",[a("el-col",{staticStyle:{"margin-top":"30px"},attrs:{span:14}},[a("el-button",{attrs:{size:"mini",icon:"el-icon-circle-plus",type:"primary"},on:{click:e.submitOnclik}},[e._v("保存设置\n        ")])],1)],1)],1)],1)},staticRenderFns:[]};var l=a("VU/8")(r,i,!1,function(e){a("Wwo0")},null,null);t.default=l.exports},bT9Y:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a("mtWM");var r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"margin-top":"20px"}},[a("el-form",[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"申请类型:",prop:"endCode"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"申请类型"},model:{value:e.property,callback:function(t){e.property=t},expression:"property"}},e._l(e.typeData,function(e){return a("el-option",{key:e.property,attrs:{label:e.mame,value:e.property}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"申请时间:",prop:"startCode"}},[a("div",{staticClass:"block"},[a("el-date-picker",{staticStyle:{width:"155px"},attrs:{"value-format":"yyyy-MM-dd",type:"date",size:"mini",placeholder:"选择日期"},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)])],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"申请班次:",prop:"endCode"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"申请班次"},model:{value:e.schedule,callback:function(t){e.schedule=t},expression:"schedule"}},e._l(e.gradeData,function(e){return a("el-option",{key:e.schedule,attrs:{label:e.mame,value:e.schedule}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"护工姓名:"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{"prefix-icon":"el-icon-edit",size:"mini",placeholder:"请输入陪护类型名称"},on:{focus:e.onclick},model:{value:e.CareWorkName,callback:function(t){e.CareWorkName=t},expression:"CareWorkName"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"时间长度:",prop:"endCode"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{"prefix-icon":"el-icon-edit",size:"mini",placeholder:"请输入时长"},model:{value:e.dayIndex,callback:function(t){e.dayIndex=t},expression:"dayIndex"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",[a("el-button",{attrs:{size:"mini",icon:"el-icon-plus",type:"primary"},on:{click:e.subminOnclick}},[e._v("提交申请")])],1)],1)],1)],1),e._v(" "),a("el-form",{ref:"addEmpForm",staticStyle:{margin:"0px",padding:"0px"}},[a("div",{staticStyle:{"text-align":"left"}},[a("el-dialog",{staticStyle:{padding:"0px"},attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.dialogVisible,width:"65%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-row",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{data:e.careWorkerList,border:"","highlight-current-row":"",size:"mini"},on:{"current-change":e.SelectionChange}},[a("el-table-column",{attrs:{prop:"code",align:"center",fixed:"",label:"员工编号"}}),e._v(" "),e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"name",align:"center",label:"员工姓名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"orgName",align:"center",label:"所在科室"}}),e._v(" "),a("el-table-column",{attrs:{prop:"startDateTime",align:"center",label:"入职时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"endDateTime",align:"center",label:"离职时间"}})],1),e._v(" "),a("div",{staticStyle:{display:"flex","justify-content":"space-between",margin:"2px",float:"right"}},[a("el-pagination",{attrs:{background:"","page-size":10,"current-page":e.currentPage,layout:"prev, pager, next",total:e.totalCount},on:{"current-change":e.currentChange}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.onClickEmp}},[e._v("确 定")])],1)],1)],1)])],1)},staticRenderFns:[]},i=a("VU/8")({data:function(){return{careWorkerList:[],dialogVisible:!1,dialogTitle:"",schedule:"1",dayIndex:"",property:"2",date:"",totalCount:-1,CareWorkName:"",currentPage:1,resourceSelection:[],tableLoading:!1,gradeData:[{schedule:"1",mame:"白班"},{grade:"2",schedule:"夜班"}],typeData:[{property:"3",mame:"请假"},{property:"2",mame:"加班"}]}},mounted:function(){},methods:{onclick:function(){this.dialogTitle="护工参照",this.dialogVisible=!0,this.getCareWorker()},SelectionChange:function(e){this.resourceSelection=e},getCareWorker:function(){var e=this;this.tableLoading=!0,this.postRequestJson("/busi/careworker/list",{name:this.name,curPage:this.currentPage,projectId:2}).then(function(t){if(e.tableLoading=!1,t&&200===t.status){var a=t.data;e.careWorkerList=t.data.msg.result,e.totalCount=a.msg.totalSize}})},onClickEmp:function(){this.resourceSelection.length<0?this.getMasgg("请选择护工"):(this.CareWorkName=this.resourceSelection.name,this.dialogVisible=!1)},subminOnclick:function(){var e=this,t=0;0<this.dayIndex<=1?((this.property=3)&&(t=0-this.dayIndex),this.postRequestJson("/busi/routine",{date:this.date,dayIndex:t,schedule:this.schedule,property:this.property,careworkerIds:[this.resourceSelection.careworkerId]}).then(function(t){e.tableLoading=!1,t&&200===t.status&&e.getMasgg(t.data.msg)})):this.getMasgg("时间长度绝对值不能大于1")},currentChange:function(e){this.currentPage=e,this.getCareWorker()},getMasgg:function(e){var t=this;this.$confirm(e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.dialogVisible=!1}).catch(function(){})}}},r,!1,null,null,null);t.default=i.exports},d0Qs:function(e,t,a){var r={"./WorkSign.vue":"bT9Y","./Workformulate.vue":"ZPWa","./Workpersonal.vue":"Ard5"};function i(e){return a(l(e))}function l(e){var t=r[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}i.keys=function(){return Object.keys(r)},i.resolve=l,e.exports=i,i.id="d0Qs"}});
//# sourceMappingURL=6.014fb8fe9cdc55da732a.js.map